# Railway deployment configuration
# See: https://docs.railway.app/reference/config-as-code

[build]
# Use Dockerfile for building (explicit DOCKERFILE to prevent RAILPACK auto-detection)
builder = "DOCKERFILE"
dockerfilePath = "Dockerfile"

# Disable watch patterns to prevent problematic auto-redeploys
[build.watchPatterns]
include = []

[deploy]
# Number of deployment instances (scale in Railway dashboard for more)
numReplicas = 1

# Health check configuration
healthcheckPath = "/health"
healthcheckTimeout = 300

# Restart policy
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 5

# Railway will set $PORT automatically
# startCommand is set per-service in Railway dashboard:
#   - web: uvicorn app.main:app --host 0.0.0.0 --port $PORT
#   - worker-1: python -m app.worker
#   - worker-2: python -m app.worker
#   - worker-3: python -m app.worker
